{
  "id": "/{{bitbucket-server.name}}",
  "instances": {{bitbucket-server.instances}},
  "cpus": {{bitbucket-server.cpus}},
  "user": "{{bitbucket-server.user}}",
  "mem": {{bitbucket-server.mem}},
  "maintainer": "support@mesosphere.io",
  "container": {
    "type": "DOCKER",
    "docker": {
      "image": "{{resource.assets.container.docker.bitbucket-server-docker}}",
    {{#bitbucket-server.bridge}}
      "network": "BRIDGE",    
      "portMappings": [
        { "containerPort": 7990, "hostPort": 0 },
        { "containerPort": 7999, "hostPort": 0 }
      ]
    {{/bitbucket-server.bridge}}
    {{^bitbucket-server.bridge}}
      "network": "HOST"
    {{/bitbucket-server.bridge}}
    },
    "volumes": [
    {
        "containerPath": "/var/atlassian/application-data/bitbucket",
        "hostPath": "{{bitbucket-server.host-volume}}/{{service.name}}",
        "mode": "RW"
    }
    ]
  },
  "acceptedResourceRoles": [
    "{{bitbucket-server.role}}"
  ],
  "healthChecks": [
    {
      "protocol": "HTTP",
      "path": "/",
      "gracePeriodSeconds": 3,
      "intervalSeconds": 10,
      "portIndex": 0,
      "timeoutSeconds": 10,
      "maxConsecutiveFailures": 0
    }
  ],
  "labels": {
    "DCOS_SERVICE_NAME": "{{bitbucket-server.name}}",
    "DCOS_SERVICE_SCHEME": "http",
    "DCOS_SERVICE_PORT_INDEX": "0"
  }
}
